generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model Config {
  id    Int    @id @default(autoincrement())
  name  String @db.Text
  value String @db.Text

  @@map("config")
}

model Countries {
  id   Int    @id @default(autoincrement()) @db.UnsignedSmallInt
  name String @unique(map: "name") @db.VarChar(255)
  code String @db.VarChar(10)

  @@map("countries")
}

model Cupons {
  id              Int     @id @default(autoincrement())
  code            String  @unique(map: "code") @db.VarChar(15)
  discount        Int
  type            Int
  cupon_condition String? @db.VarChar(10)
  parameter       Int?
  description     String? @db.Text
  active          Int     @default(1)

  @@map("cupons")
}

model CuponsUsed {
  id         Int      @id @default(autoincrement())
  user_id    Int
  cupon_id   Int
  date_cupon DateTime @db.DateTime(0)

  @@map("cupons_used")
}

model DescargasUser {
  id        Int      @id @default(autoincrement())
  user_id   Int
  order_id  Int?
  available Float    @db.Float
  ilimitado Int      @default(0)
  date_end  DateTime @db.Date

  @@map("descargas_user")
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model FtpGroup {
  groupname String @db.VarChar(16)
  gid       Int    @default(5500) @db.SmallInt
  members   String @db.VarChar(16)
  id        Int    @id @default(autoincrement())

  @@index([groupname], map: "groupname")
  @@map("ftpgroup")
}

model FtpQuotaLimits {
  id               Int                        @id @default(autoincrement())
  name             String?                    @db.VarChar(30)
  quota_type       ftpquotalimits_quota_type  @default(user)
  per_session      ftpquotalimits_per_session @default(false)
  limit_type       ftpquotalimits_limit_type  @default(soft)
  bytes_in_avail   BigInt                     @default(0) @db.UnsignedBigInt
  bytes_out_avail  BigInt                     @default(0) @db.UnsignedBigInt
  bytes_xfer_avail BigInt                     @default(0) @db.UnsignedBigInt
  files_in_avail   Int                        @default(0) @db.UnsignedInt
  files_out_avail  Int                        @default(0) @db.UnsignedInt
  files_xfer_avail Int                        @default(0) @db.UnsignedInt

  @@map("ftpquotalimits")
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model FtpUser {
  id         Int       @id @default(autoincrement()) @db.UnsignedInt
  userid     String    @unique(map: "userid") @default("") @db.VarChar(32)
  passwd     String    @default("") @db.VarChar(32)
  uid        Int       @default(5500) @db.SmallInt
  gid        Int       @default(5500) @db.SmallInt
  homedir    String    @default("") @db.VarChar(255)
  shell      String    @default("/sbin/nologin") @db.VarChar(16)
  count      Int       @default(0)
  accessed   DateTime  @default(dbgenerated("'1999-01-01 00:00:00'")) @db.DateTime(0)
  modified   DateTime  @default(dbgenerated("'1999-01-01 00:00:00'")) @db.DateTime(0)
  user_id    Int?
  order_id   Int?
  expiration DateTime? @db.Date

  @@map("ftpuser")
}

model LoginHistory {
  id        Int     @id @default(autoincrement()) @db.UnsignedInt
  user      String  @db.VarChar(50)
  client_ip String  @db.VarChar(100)
  server_ip String  @db.VarChar(100)
  protocol  String  @db.Text
  when      String? @db.VarChar(150)

  @@map("login_history")
}

model Orders {
  id             Int      @id @default(autoincrement())
  date_order     DateTime @db.DateTime(0)
  payment_id     Int?
  user_id        Int
  total_price    Float    @db.Float
  status         Int      @default(0)
  discount       Int      @default(0)
  total_discount Float?   @db.Float
  cupon_id       Int?
  is_plan        Int      @default(0)
  plan_id        Int?
  txn_id         String?  @db.VarChar(100)
  payment_method String?  @db.Text
  invoice_id     String?  @db.Text
  is_canceled    Int?     @default(0)

  @@map("orders")
}

model Plans {
  id                   Int     @id @default(autoincrement())
  name                 String  @db.VarChar(100)
  description          String  @db.Text
  moneda               String  @default("usd") @db.VarChar(200)
  homedir              String  @db.Text
  gigas                BigInt  @default(0)
  price                Decimal @db.Decimal(10, 2)
  duration             String  @db.VarChar(100)
  activated            Int     @default(0)
  tokens               Int?
  audio_ilimitado      Int?
  tokens_video         Int?
  video_ilimitado      Int?
  tokens_karaoke       Int?
  karaoke_ilimitado    Int?
  ilimitado_activo     Int?
  ilimitado_dias       Int?
  stripe_prod_id       String? @db.Text
  stripe_prod_id_test  String? @db.Text
  vip_activo           Int?
  conekta_plan_id      String? @db.Text
  conekta_plan_id_test String? @db.Text
  paypal_plan_id       String? @db.Text
  paypal_plan_id_test  String? @db.Text
  paypal_product_id    String? @db.Text

  @@map("plans")
}

model Roles {
  id   Int    @id @default(autoincrement())
  name String @unique(map: "name") @db.VarChar(255)

  @@map("roles")
}

model UserFiles {
  id             Int       @id @default(autoincrement())
  product_id     String    @db.VarChar(200)
  downloads_left Int
  order_id       Int
  user_id        Int
  since          DateTime? @db.Date

  @@map("user_files")
}

model Users {
  id                       Int                        @id @default(autoincrement())
  registered_on            DateTime                   @default(dbgenerated("'2018-01-01'")) @db.Date
  username                 String                     @unique(map: "username") @db.VarChar(255)
  password                 String                     @db.LongText
  first_name               String?                    @db.VarChar(255)
  last_name                String?                    @db.VarChar(255)
  address                  String?                    @db.VarChar(255)
  birthdate                DateTime?                  @db.Date
  email                    String                     @unique(map: "email") @db.VarChar(255)
  stripe_cusid             String?                    @db.VarChar(200)
  conekta_cusid            String?                    @db.VarChar(255)
  phone                    String?                    @db.VarChar(15)
  city                     String?                    @db.VarChar(100)
  role_id                  Int?                       @default(1)
  country_id               String?                    @db.VarChar(2)
  profile_img              String?                    @db.VarChar(100)
  active                   Int                        @default(0)
  activationcode           String?                    @db.Text
  mc_id                    Int?
  ip_registro              String?                    @db.Text
  token_expiration         DateTime?                  @db.Date
  refresh_token            String?                    @db.VarChar(250)
  blocked                  Boolean                    @default(false)
  jobs                     jobs[]
  dir_downloads            dir_downloads[]
  product_orders           product_orders[]
  checkout_logs            checkout_logs[]
  change_plan_transactions change_plan_transactions[]

  @@map("users")
}

model Ftpquotatallies {
  name            String                     @default("") @db.VarChar(30)
  quota_type      ftpquotatallies_quota_type @default(user)
  bytes_in_used   BigInt                     @default(0) @db.UnsignedBigInt
  bytes_out_used  BigInt                     @default(0) @db.UnsignedBigInt
  bytes_xfer_used BigInt                     @default(0) @db.UnsignedBigInt
  files_in_used   Int                        @default(0) @db.UnsignedInt
  files_out_used  Int                        @default(0) @db.UnsignedInt
  files_xfer_used Int                        @default(0) @db.UnsignedInt
  id              Int                        @id @default(autoincrement())

  @@map("ftpquotatallies")
}

model FtpQuotaTalliesHistory {
  id              Int                                @id @default(autoincrement())
  name            String                             @db.VarChar(30)
  quota_type      ftpquotatallies_history_quota_type @default(user)
  bytes_in_used   BigInt                             @default(0) @db.UnsignedBigInt
  bytes_out_used  BigInt                             @default(0) @db.UnsignedBigInt
  bytes_xfer_used BigInt                             @default(0) @db.UnsignedBigInt
  files_in_used   Int                                @default(0) @db.UnsignedInt
  files_out_used  Int                                @default(0) @db.UnsignedInt
  files_xfer_used Int                                @default(0) @db.UnsignedInt

  @@map("ftpquotatallies_history")
}

model product_orders {
  id             Int       @id @default(autoincrement())
  service        String    @db.VarChar(100)
  product_id     Int
  created_at     DateTime? @db.DateTime(0)
  status         Int
  user_id        Int
  payment_method String?   @default("Stripe") @db.VarChar(250)
  txn_id         String?   @default("") @db.VarChar(100)
  products       products  @relation(fields: [product_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "FK_products")
  users          Users     @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_user")

  @@index([product_id], map: "FK_products")
  @@index([user_id], map: "fk_user")
}

model products {
  id                     Int              @id @default(autoincrement())
  name                   String           @db.VarChar(250)
  stripe_product_test_id String           @db.VarChar(50)
  stripe_product_id      String           @db.VarChar(50)
  amount                 Float            @db.Float
  price                  Float?           @default(350) @db.Float
  moneda                 String?          @default("MXN") @db.VarChar(10)
  product_orders         product_orders[]
}

model dir_downloads {
  id          Int       @id @default(autoincrement())
  userId      Int?
  size        BigInt?
  date        DateTime? @db.DateTime(0)
  dirName     String    @db.VarChar(500)
  // This is the id of the db job entity
  jobId       Int?
  downloadUrl String?   @db.VarChar(1000)
  users       Users?    @relation(fields: [userId], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "dir_downloads_ibfk_1")
  expirationDate DateTime? @db.DateTime(0)
}

model jobs {
  id         Int       @id @default(autoincrement())
  user_id    Int
  queue      String    @db.VarChar(255)
  status     String    @db.VarChar(50)
  createdAt  DateTime  @db.DateTime(0)
  // This is the id of the job in the queue
  jobId      String?   @db.VarChar(255)
  finishedAt DateTime? @db.DateTime(0)
  users      Users     @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "jobs_ibfk_1")
}

model checkout_logs {
  id                 Int      @id @default(autoincrement())
  user_id            Int
  last_checkout_date DateTime @db.DateTime(0)
  users              Users    @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "checkout_logs_ibfk_1")

  @@index([user_id], map: "user_id")
}

model change_plan_transactions {
  id                      Int      @id @default(autoincrement())
  userId                  Int
  user                    Users    @relation(fields: [id], references: [id], onDelete: Cascade)
  newPlanId               Int
  oldPlanId               Int
  createdAt               DateTime @db.DateTime(0)
}

enum ftpquotalimits_quota_type {
  user
  group
  class
  all
}

enum ftpquotalimits_per_session {
  false
  true
}

enum ftpquotalimits_limit_type {
  soft
  hard
}

enum ftpquotatallies_quota_type {
  user
  group
  class
  all
}

enum ftpquotatallies_history_quota_type {
  user
  group
  class
  all
}
