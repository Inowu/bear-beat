# Build desde la raíz del monorepo para que publish sea frontend/dist (Vite)
[build]
  base = "."
  command = "npm run build"
  publish = "frontend/dist"

[build.environment]
  NODE_VERSION = "24"
  CI = "false"
  REACT_APP_ENVIRONMENT = "production"

  # PayPal (clientId es público; requerido para que se rendericen los botones)
  REACT_APP_PAYPAL_CLIENT_ID = "AYuKvAI09TE9bk9k1TuzodZ2zWQFpWEZesT65IkT4WOws9wq-yfeHLj57kEBH6YR_8NgBUlLShj2HOSr"
  REACT_APP_PAYPAL_CLIENT_TEST_ID = "Afu3XeDQNkiDP08dsJuEjeQf6swc8hW6nBPdhXljD0Ra0XK5bewP2EGrbcei3u0-Fx_tcKUZDWuZWuWC"

  # Hotjar (2026) puede venir como tag de Contentsquare UXA.
  # No es un secreto (es un ID de tag / script público).
  REACT_APP_CONTENTSQUARE_TAG_ID = "6e820b371a0f9"
  REACT_APP_HOTJAR_ENABLED = "1"
  # 0 = solo conversión | 1 = todo el sitio (excepto /admin)
  # Nota: necesario si quieres ver grabaciones también dentro de la app (no solo LP/Auth/Checkout).
  REACT_APP_UX_TRACK_ALL = "1"

[[headers]]
  for = "/*"
  [headers.values]
    X-Content-Type-Options = "nosniff"
    Referrer-Policy = "strict-origin-when-cross-origin"
    # Clickjacking protection (primary) + legacy support.
    Content-Security-Policy = "frame-ancestors 'none';"
    X-Frame-Options = "DENY"
    # Disable high-risk browser features not needed by the site.
    Permissions-Policy = "geolocation=(), microphone=(), camera=(), usb=()"
    X-Permitted-Cross-Domain-Policies = "none"
    # Performance: allow caching but always revalidate HTML/documents.
    # Hashed assets are long-term cached (see /assets/* below).
    Cache-Control = "no-cache"
    Pragma = "no-cache"
    Expires = "0"

[[headers]]
  for = "/index.html"
  [headers.values]
    Cache-Control = "no-cache"
    Pragma = "no-cache"
    Expires = "0"

[[headers]]
  for = "/manifest.json"
  [headers.values]
    Cache-Control = "no-cache"

[[headers]]
  for = "/asset-manifest.json"
  [headers.values]
    Cache-Control = "no-cache"

[[headers]]
  for = "/assets/*"
  [headers.values]
    Cache-Control = "public, max-age=31536000, immutable"
